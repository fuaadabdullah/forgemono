# Default values for argo-rollouts.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# Argo Rollouts controller configuration
controller:
  # -- Number of replicas for the Argo Rollouts controller
  replicas: 1

  # -- Image for the Argo Rollouts controller
  image:
    registry: quay.io
    repository: argoproj/argo-rollouts
    tag: ""
    pullPolicy: IfNotPresent

  # -- Service account for the controller
  serviceAccount:
    create: true
    name: argo-rollouts

  # -- RBAC configuration
  rbac:
    create: true

  # -- Cluster role rules
  clusterRoleRules:
    - apiGroups:
        - argoproj.io
      resources:
        - rollouts
        - rollouts/status
        - rollouts/finalizers
        - analysisruns
        - analysisruns/status
        - analysistemplates
        - analysistemplates/status
        - clusteranalysistemplates
        - clusteranalysistemplates/status
        - experiments
        - experiments/status
        - experiments/finalizers
      verbs:
        - "*"
    - apiGroups:
        - ""
      resources:
        - pods
        - services
        - endpoints
        - events
        - configmaps
        - secrets
      verbs:
        - "*"
    - apiGroups:
        - apps
      resources:
        - deployments
        - replicasets
      verbs:
        - "*"
    - apiGroups:
        - networking.k8s.io
      resources:
        - ingresses
      verbs:
        - get
        - list
        - watch
    - apiGroups:
        - extensions
      resources:
        - ingresses
      verbs:
        - get
        - list
        - watch

  # Prometheus metrics
  metrics:
    enabled: true
    serviceMonitor:
      enabled: false

# Dashboard configuration
dashboard:
  enabled: true
  service:
    type: ClusterIP
    port: 3100

# Istio integration (for traffic management)
istio:
  enabled: true
