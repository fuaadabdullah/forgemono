name = "goblin-assistant-edge"
main = "worker.js"
compatibility_date = "2023-10-30"
account_id = "a9c52e892f7361bab3bfd084c6ffaccb"

# KV Namespace for caching and rate limiting
[[kv_namespaces]]
binding = "GOBLIN_CACHE"
id = "9e1c27d3eda84c759383cb2ac0b15e4c"

# D1 Database for structured data (SQLite at the edge)
[[d1_databases]]
binding = "DB"
database_name = "goblin-assistant-db"
database_id = "8af5cf0e-f749-47ab-b7ad-22daa135fb75"

# Analytics Engine for free observability (fallback for Datadog)
# TEMPORARILY COMMENTED OUT - Enable Analytics Engine first via Dashboard
# After enabled, uncomment and redeploy
# [[analytics_engine_datasets]]
# binding = "GOBLIN_ANALYTICS"

# R2 Storage Buckets (Cheap storage for files)
[[r2_buckets]]
binding = "GOBLIN_AUDIO"
bucket_name = "goblin-audio"
preview_bucket_name = "goblin-audio-preview"

[[r2_buckets]]
binding = "GOBLIN_LOGS"
bucket_name = "goblin-logs"
preview_bucket_name = "goblin-logs-preview"

[[r2_buckets]]
binding = "GOBLIN_UPLOADS"
bucket_name = "goblin-uploads"
preview_bucket_name = "goblin-uploads-preview"

[[r2_buckets]]
binding = "GOBLIN_TRAINING"
bucket_name = "goblin-training"
preview_bucket_name = "goblin-training-preview"

[[r2_buckets]]
binding = "GOBLIN_CACHE_R2"
bucket_name = "goblin-cache"
preview_bucket_name = "goblin-cache-preview"

# Environment variables
[vars]
API_URL = "https://api.goblin.fuaad.ai"
FRONTEND_URL = "https://goblin.fuaad.ai"
OPS_URL = "https://ops.goblin.fuaad.ai"
TURNSTILE_SECRET_KEY_MANAGED = "0x4AAAAAACEUKE7kvHG6UR6T7NO65u1aAv4"
TURNSTILE_SECRET_KEY_INVISIBLE = "0x4AAAAAACEUKRzmrB-1uKPfN2NUuN61bVI"

# Rate limiting (Step 3: rate limiting user requests)
# [[unsafe.bindings]]
# name = "RATE_LIMITER"
# type = "ratelimit"
# namespace_id = "your-ratelimit-namespace-id"
